<!DOCTYPE html>
<html lang="en">
    <head>
        <title>ExpenseTracker</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" 
  rel="stylesheet">
    </head>
    <body>
        <div class="container mt-3 bg-light">
            <h2 class="text-center">ExpenseTracker</h2>
            <form onsubmit="localStorageValue(event)">
                <div class="mb-3 mt-3">
                <lable for="costmer">Choose Id</lable>
                <input type="text" id="Id" class="form-control" placeholder="choose id"
                name="Id">
                </div>
                <div class="mb-3 mt-3">
                    <label for="amount">Fill Expense Amount</label>
                    <input type="text" id="amount"class="form-control"placeholder=
                    "fill amount" name="amount">
                </div>
                <div class="mb-3 mt-3">
                    <label for="description">Choose description</label>
                    <input type="text" id="description"class="form-control"placeholder=
                    "Choose Description">
               <div class="mb-3 mt-3">
                <label for="category">Choose a Category</label>
                <input type="text"id="choose" placeholder="choose a category" class="form-control">
                </div>
             <button type="submit" class="btn btn-dark text-white">Add Expenses</button>
            </form>
        </div> 
        <ul id="list">

        </ul>
        <script>
            function localStorageValue(event){
                event.preventDefault();
                const ide=event.target.Id.value;
                const fill=event.target.amount.value;
                const description=event.target.description.value;
                const choose=event.target.choose.value;
                let obj={
                    ide,
                    fill,
                    description,
                    choose
                }
                let obj_serialized=JSON .stringify(obj);
                localStorage.setItem(obj.ide,obj_serialized); 
                showDetailsOnScreen(obj)           
            }
            function showDetailsOnScreen(user)
            {
                
              if(localStorage.getItem(user.ide!=null))
              {
                removeUserFromScreen(user.ide);
              }
              const parentNode=document.getElementById('list')
              const childHTML=`<li id=${user.ide}>${user.ide}-${user.fill}-
                ${user.description} -${user.choose}
                <button onclick=deleteExpenses('${user.ide}')>Delete Expenses</button>
                <button onclick=EditExpenses('${user.email}')>EditeExpenses</button>
                </li>`
                parentNode.innerHTML=parentNode.innerHTML+childHTML;
            }
            window.addEventListener("DOMContentLoaded",()=>{
                const localStorageObj=localStorage;
                const localStorageKeys=Object.keys(localStorageObj);
                for(var i=0;i<localStorageKeys.length;i++){
                    const key=localStorageKeys[i];
                    const localStorageData=localStorageObj[key];
                    const userDetailsObj=JSON.parse(localStorageData);
                    showDetailsOnScreen(userDetailsObj)

                }
            })
            function deleteExpenses(Id){
                 localStorage.removeItem(Id);
                 removeUserFromScreen(Id);

            }
            function removeUserFromScreen(Id)
            {
                const parentNode=document.getElementById('list');
                const childNodeToBeDeleted=document.getElementById(Id);
                parentNode.removeChild(childNodeToBeDeleted);
            }
            function EditExpenses(Id)
            {
                document.getElementById('Id').value=ide;
                document.getElementById('amount').value=fill;
                document.getElementById('description').value=description;
                document.getElementById('choose').value=choose;
                removeUserFromScreen(Id);
                deleteExpenses(Id);
            }
        </script>
    </body>
</html>